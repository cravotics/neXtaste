<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçΩÔ∏è TasteTrailOps - AI-Powered Food Discovery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Dancing+Script:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'poppins': ['Poppins', 'sans-serif'],
                        'dancing': ['Dancing Script', 'cursive'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'slideInLeft': 'slideInLeft 0.8s ease-out',
                        'slideInRight': 'slideInRight 0.8s ease-out',
                        'fadeInUp': 'fadeInUp 0.8s ease-out',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .food-hero-bg {
            background: linear-gradient(135deg, rgba(255,107,0,0.9) 0%, rgba(255,193,7,0.8) 50%, rgba(76,175,80,0.7) 100%),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="%23ffffff20"><circle cx="100" cy="50" r="30"/><circle cx="300" cy="30" r="20"/><circle cx="500" cy="70" r="25"/><circle cx="700" cy="40" r="15"/><circle cx="900" cy="60" r="35"/></svg>');
            background-size: cover, 100% 100%;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .food-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .food-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.6s;
        }
        
        .food-card:hover::before {
            left: 100%;
        }
        
        .food-card:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            border: 2px solid #ff6b35;
        }
        
        .food-gradient {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 25%, #ffd700 50%, #32cd32 75%, #ff4081 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }
        
        .taste-button {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .taste-button:hover {
            background: linear-gradient(45deg, #f7931e, #ff6b35);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.4);
        }
        
        .taste-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .taste-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .nav-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .food-icon {
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
            transition: all 0.3s ease;
        }
        
        .food-icon:hover {
            transform: scale(1.2) rotate(10deg);
            filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
        }
        
        .pulse-food {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .loading-food {
            animation: spin 1s linear infinite, bounce 2s infinite;
        }
        
        .dish-preview {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .dish-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes wiggle {
            0%, 7% { transform: rotateZ(0); }
            15% { transform: rotateZ(-15deg); }
            20% { transform: rotateZ(10deg); }
            25% { transform: rotateZ(-10deg); }
            30% { transform: rotateZ(6deg); }
            35% { transform: rotateZ(-4deg); }
            40%, 100% { transform: rotateZ(0); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff6b35, 0 0 20px #ff6b35; }
            to { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff6b35, 0 0 40px #ff6b35; }
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .emoji-float {
            position: absolute;
            font-size: 2rem;
            animation: float 6s ease-in-out infinite;
            opacity: 0.7;
        }
        
        .preference-tag {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .preference-tag:hover {
            transform: scale(1.1);
        }
        
        .preference-tag.selected {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            color: white;
            animation: bounce 0.6s;
        }
        
        .nutrition-bar {
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            background: #e2e8f0;
            position: relative;
        }
        
        .nutrition-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #f7931e, #ffd700);
            border-radius: 4px;
            animation: fillAnimation 2s ease-out;
        }
        
        @keyframes fillAnimation {
            from { width: 0%; }
            to { width: var(--fill-width); }
        }
        
        .dish-card-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="min-h-screen relative overflow-x-hidden" x-data="tasteTrailApp()">
    <!-- Floating Food Emojis -->
    <div class="emoji-float" style="top: 10%; left: 5%; animation-delay: 0s;">üçï</div>
    <div class="emoji-float" style="top: 20%; right: 10%; animation-delay: 1s;">üçú</div>
    <div class="emoji-float" style="top: 70%; left: 8%; animation-delay: 2s;">üç∞</div>
    <div class="emoji-float" style="top: 80%; right: 15%; animation-delay: 3s;">üçî</div>
    <div class="emoji-float" style="top: 50%; left: 2%; animation-delay: 4s;">üç±</div>
    <div class="emoji-float" style="top: 30%; right: 5%; animation-delay: 5s;">üç≤</div>

    <!-- Navigation -->
    <nav class="nav-glass fixed w-full top-0 z-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center animate-slideInLeft">
                    <div class="flex-shrink-0">
                        <h1 class="text-3xl font-bold text-white font-dancing animate-glow">
                            <i class="fas fa-utensils mr-3 food-icon text-yellow-300"></i>
                            TasteTrailOps
                        </h1>
                        <p class="text-sm text-gray-200 ml-12 font-light">AI-Powered Food Discovery</p>
                    </div>
                </div>
                <div class="flex items-center space-x-8 animate-slideInRight">
                    <button @click="activeTab = 'recommendations'" 
                            :class="activeTab === 'recommendations' ? 'text-yellow-300 scale-110' : 'text-white'"
                            class="hover:text-yellow-300 transition-all duration-300 flex flex-col items-center group">
                        <i class="fas fa-star text-2xl mb-1 group-hover:animate-bounce-slow food-icon"></i>
                        <span class="text-xs font-medium">Discover</span>
                    </button>
                    <button @click="activeTab = 'analyze'" 
                            :class="activeTab === 'analyze' ? 'text-yellow-300 scale-110' : 'text-white'"
                            class="hover:text-yellow-300 transition-all duration-300 flex flex-col items-center group">
                        <i class="fas fa-camera text-2xl mb-1 group-hover:animate-pulse food-icon"></i>
                        <span class="text-xs font-medium">Analyze</span>
                    </button>
                    <button @click="activeTab = 'preferences'" 
                            :class="activeTab === 'preferences' ? 'text-yellow-300 scale-110' : 'text-white'"
                            class="hover:text-yellow-300 transition-all duration-300 flex flex-col items-center group">
                        <i class="fas fa-cog text-2xl mb-1 group-hover:animate-wiggle food-icon"></i>
                        <span class="text-xs font-medium">Preferences</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="food-hero-bg pt-20 pb-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="animate-fadeInUp">
                <h2 class="text-5xl md:text-7xl font-bold text-white mb-6 font-dancing animate-glow">
                    Discover Your Perfect Meal
                </h2>
                <p class="text-xl md:text-2xl text-white/90 mb-8 font-light">
                    AI-powered recommendations tailored to your taste buds üéØ
                </p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 -mt-8 relative z-10">
        
        <!-- User ID & Health Check Card -->
        <div class="glass-card rounded-3xl p-8 mb-8 animate-fadeInUp">
            <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6">
                <div class="flex-1 w-full">
                    <label for="userId" class="block text-lg font-semibold text-white mb-3 flex items-center">
                        <i class="fas fa-user-circle mr-2 text-yellow-300"></i>
                        Your Foodie ID
                    </label>
                    <input type="text" id="userId" x-model="userId" 
                           placeholder="Enter your unique foodie ID (e.g., foodie123)"
                           class="w-full px-6 py-4 rounded-2xl border-2 border-white/30 bg-white/20 text-white placeholder-white/70 focus:border-yellow-300 focus:bg-white/30 transition-all duration-300 text-lg">
                </div>
                <button @click="checkApiHealth()" 
                        class="taste-button text-white px-8 py-4 rounded-2xl font-semibold text-lg flex items-center space-x-3 relative z-10 hover:scale-105 transition-all duration-300">
                    <i class="fas fa-heartbeat text-xl"></i>
                    <span>Health Check</span>
                </button>
            </div>
            <div x-show="apiHealth" 
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 transform scale-90"
                 x-transition:enter-end="opacity-100 transform scale-100"
                 class="mt-6 p-6 rounded-2xl" 
                 :class="apiHealth && apiHealth.status === 'healthy' ? 'bg-green-500/20 border border-green-400/50' : 'bg-red-500/20 border border-red-400/50'">
                <div class="flex items-center justify-center space-x-3">
                    <i :class="apiHealth && apiHealth.status === 'healthy' ? 'fas fa-check-circle text-green-400 text-2xl animate-bounce-slow' : 'fas fa-exclamation-circle text-red-400 text-2xl animate-pulse'"></i>
                    <span class="text-white font-semibold text-lg" x-text="apiHealth && apiHealth.status === 'healthy' ? 'üéâ API is healthy and ready to serve delicious recommendations!' : 'üòî API is taking a coffee break. Please try again!'"></span>
                </div>
            </div>
        </div>

        <!-- Recommendations Tab -->
        <div x-show="activeTab === 'recommendations'" 
             x-transition:enter="transition ease-out duration-500"
             x-transition:enter-start="opacity-0 transform scale-95"
             x-transition:enter-end="opacity-100 transform scale-100"
             class="space-y-8">
            
            <div class="glass-card rounded-3xl p-8 animate-fadeInUp">
                <h2 class="text-4xl font-bold text-white mb-8 text-center">
                    <i class="fas fa-star text-yellow-300 mr-3 animate-pulse-slow"></i>
                    <span class="font-dancing">Discover Amazing Food</span>
                    <i class="fas fa-star text-yellow-300 ml-3 animate-pulse-slow"></i>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="space-y-3">
                        <label class="flex items-center text-lg font-semibold text-white">
                            <i class="fas fa-map-marker-alt mr-2 text-yellow-300"></i>
                            Location
                        </label>
                        <input type="text" x-model="location" placeholder="üåç Where are you? (e.g., New York, NY)"
                               class="w-full px-6 py-4 rounded-2xl border-2 border-white/30 bg-white/20 text-white placeholder-white/70 focus:border-yellow-300 focus:bg-white/30 transition-all duration-300">
                    </div>
                    <div class="space-y-3">
                        <label class="flex items-center text-lg font-semibold text-white">
                            <i class="fas fa-clock mr-2 text-yellow-300"></i>
                            Meal Time
                        </label>
                        <select x-model="mealType" class="w-full px-6 py-4 rounded-2xl border-2 border-white/30 bg-white/20 text-white focus:border-yellow-300 focus:bg-white/30 transition-all duration-300">
                            <option value="" class="text-gray-800">üçΩÔ∏è Any Time</option>
                            <option value="breakfast" class="text-gray-800">üåÖ Breakfast</option>
                            <option value="lunch" class="text-gray-800">‚òÄÔ∏è Lunch</option>
                            <option value="dinner" class="text-gray-800">üåô Dinner</option>
                            <option value="brunch" class="text-gray-800">ü•ê Brunch</option>
                        </select>
                    </div>
                    <div class="space-y-3">
                        <label class="flex items-center text-lg font-semibold text-white">
                            <i class="fas fa-wallet mr-2 text-yellow-300"></i>
                            Budget Range
                        </label>
                        <select x-model="budgetRange" class="w-full px-6 py-4 rounded-2xl border-2 border-white/30 bg-white/20 text-white focus:border-yellow-300 focus:bg-white/30 transition-all duration-300">
                            <option value="" class="text-gray-800">üí∞ Any Budget</option>
                            <option value="budget" class="text-gray-800">üíµ Budget ($)</option>
                            <option value="moderate" class="text-gray-800">üí¥ Moderate ($$)</option>
                            <option value="premium" class="text-gray-800">üíé Premium ($$$)</option>
                        </select>
                    </div>
                </div>

                <button @click="getRecommendations()" :disabled="!userId || loading"
                        class="w-full taste-button text-white py-6 px-8 rounded-2xl font-bold text-xl flex items-center justify-center space-x-4 relative z-10 hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i :class="loading ? 'fas fa-spinner loading-food' : 'fas fa-search'" class="text-2xl"></i>
                    <span x-text="loading ? 'Finding Perfect Dishes...' : 'Find My Perfect Meal üéØ'"></span>
                </button>
            </div>

            <!-- Recommendations Results -->
            <div x-show="recommendations.length > 0" 
                 x-transition:enter="transition ease-out duration-700"
                 x-transition:enter-start="opacity-0 transform translateY(20px)"
                 x-transition:enter-end="opacity-100 transform translateY(0)"
                 class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <template x-for="(food, index) in recommendations" :key="food.id">
                    <div class="food-card group"
                         x-transition:enter="transition ease-out duration-500"
                         x-transition:enter-start="opacity-0 transform scale-95"
                         x-transition:enter-end="opacity-100 transform scale-100"
                         :style="`animation-delay: ${index * 0.1}s`">
                        
                        <!-- Food Image with Dynamic Background -->
                        <div class="dish-preview h-48 relative"
                             :style="`background-image: url('https://source.unsplash.com/400x300/food,${food.cuisine_type.toLowerCase()}')`">
                            <div class="absolute top-4 right-4 bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-sm font-bold text-gray-800 flex items-center space-x-1">
                                <i class="fas fa-star text-yellow-500"></i>
                                <span x-text="food.rating"></span>
                            </div>
                            <div class="absolute top-4 left-4 cuisine-badge"
                                 :class="getCuisineColor(food.cuisine_type)">
                                <span x-text="food.cuisine_type" class="text-xs font-bold"></span>
                            </div>
                        </div>
                        
                        <div class="p-6 relative z-10">
                            <h3 class="text-2xl font-bold text-gray-900 mb-3 group-hover:text-orange-600 transition-colors duration-300" x-text="food.name"></h3>
                            <p class="text-gray-600 mb-4 leading-relaxed" x-text="food.description"></p>
                            
                            <div class="flex justify-between items-center mb-4">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-utensils text-orange-500"></i>
                                    <span class="bg-gradient-to-r from-orange-400 to-pink-400 bg-clip-text text-transparent font-bold" x-text="food.meal_type || 'Any Time'"></span>
                                </div>
                                <div class="text-2xl font-bold text-green-600 flex items-center">
                                    <i class="fas fa-dollar-sign text-sm mr-1"></i>
                                    <span x-text="food.price.toFixed(2)"></span>
                                </div>
                            </div>
                            
                            <!-- Qloo Insights -->
                            <div x-show="food.qloo_insights && food.qloo_insights.length > 0" class="mb-4">
                                <div class="text-sm text-gray-500 mb-2 flex items-center">
                                    <i class="fas fa-lightbulb text-yellow-500 mr-1"></i>
                                    AI Insights
                                </div>
                                <div class="flex flex-wrap gap-1">
                                    <template x-for="insight in food.qloo_insights.slice(0, 2)">
                                        <span class="bg-gradient-to-r from-blue-100 to-purple-100 text-blue-800 text-xs px-2 py-1 rounded-full" x-text="insight"></span>
                                    </template>
                                </div>
                            </div>
                            
                            <button class="w-full bg-gradient-to-r from-orange-500 to-pink-500 text-white px-6 py-3 rounded-xl font-bold hover:from-orange-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 flex items-center justify-center space-x-2 group">
                                <i class="fas fa-heart group-hover:animate-bounce-slow"></i>
                                <span>Order Now</span>
                                <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform duration-300"></i>
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- Food Analysis Tab -->
        <div x-show="activeTab === 'analyze'" 
             x-transition:enter="transition ease-out duration-500"
             x-transition:enter-start="opacity-0 transform scale-95"
             x-transition:enter-end="opacity-100 transform scale-100"
             class="space-y-8">
            
            <div class="glass-card rounded-3xl p-8 animate-fadeInUp">
                <h2 class="text-4xl font-bold text-white mb-8 text-center">
                    <i class="fas fa-camera text-yellow-300 mr-3 animate-pulse"></i>
                    <span class="font-dancing">AI Food Scanner</span>
                    <i class="fas fa-brain text-yellow-300 ml-3 animate-pulse"></i>
                </h2>
                
                <div class="mb-8">
                    <label class="flex items-center text-lg font-semibold text-white mb-4">
                        <i class="fas fa-image mr-2 text-yellow-300"></i>
                        Food Image URL
                    </label>
                    <div class="flex space-x-4">
                        <input type="url" x-model="imageUrl" placeholder="üñºÔ∏è Paste image URL here (e.g., https://images.unsplash.com/photo-...)"
                               class="flex-1 px-6 py-4 rounded-2xl border-2 border-white/30 bg-white/20 text-white placeholder-white/70 focus:border-yellow-300 focus:bg-white/30 transition-all duration-300">
                        <button @click="useRandomFoodImage()" 
                                class="px-6 py-4 bg-purple-500/80 hover:bg-purple-600/80 text-white rounded-2xl font-semibold transition-all duration-300 hover:scale-105 flex items-center space-x-2">
                            <i class="fas fa-random"></i>
                            <span>Random</span>
                        </button>
                    </div>
                    <p class="mt-3 text-white/80 text-sm flex items-center">
                        <i class="fas fa-info-circle mr-2 text-blue-300"></i>
                        Upload any food image URL for instant AI analysis with nutritional insights
                    </p>
                </div>

                <button @click="analyzeImage()" :disabled="!userId || !imageUrl || loading"
                        class="w-full taste-button text-white py-6 px-8 rounded-2xl font-bold text-xl flex items-center justify-center space-x-4 relative z-10 hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i :class="loading ? 'fas fa-spinner loading-food' : 'fas fa-magic'" class="text-2xl"></i>
                    <span x-text="loading ? 'AI is analyzing your food...' : 'Analyze Food with AI ü§ñ'"></span>
                </button>
            </div>

            <!-- Image Preview -->
            <div x-show="imageUrl" 
                 x-transition:enter="transition ease-out duration-500"
                 x-transition:enter-start="opacity-0 transform scale-95"
                 x-transition:enter-end="opacity-100 transform scale-100"
                 class="glass-card rounded-3xl p-6">
                <h3 class="text-2xl font-bold text-white mb-4 flex items-center">
                    <i class="fas fa-eye mr-2 text-green-400"></i>
                    Image Preview
                </h3>
                <div class="relative overflow-hidden rounded-2xl">
                    <img :src="imageUrl" :alt="'Food preview'" 
                         class="w-full h-64 object-cover transform hover:scale-110 transition-transform duration-500"
                         @error="imageError = true"
                         @load="imageError = false">
                    <div x-show="imageError" class="absolute inset-0 bg-gray-800/50 flex items-center justify-center">
                        <div class="text-white text-center">
                            <i class="fas fa-exclamation-triangle text-4xl mb-2 text-yellow-400"></i>
                            <p class="font-semibold">Unable to load image</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analysis Results -->
            <div x-show="analysisResults" 
                 x-transition:enter="transition ease-out duration-700"
                 x-transition:enter-start="opacity-0 transform translateY(20px)"
                 x-transition:enter-end="opacity-100 transform translateY(0)"
                 class="glass-card rounded-3xl p-8">
                <h3 class="text-3xl font-bold text-white mb-6 flex items-center">
                    <i class="fas fa-microscope text-green-400 mr-3 animate-bounce-slow"></i>
                    <span class="font-dancing">AI Analysis Results</span>
                </h3>
                
                <div x-show="analysisResults?.detected_foods?.length > 0" class="space-y-6">
                    <template x-for="(food, index) in analysisResults.detected_foods" :key="food.name">
                        <div class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6 hover:bg-white/20 transition-all duration-300"
                             x-transition:enter="transition ease-out duration-500"
                             x-transition:enter-start="opacity-0 transform translateX(-20px)"
                             x-transition:enter-end="opacity-100 transform translateX(0)"
                             :style="`animation-delay: ${index * 0.2}s`">
                            
                            <div class="flex justify-between items-start mb-4">
                                <h4 class="text-2xl font-bold text-white flex items-center">
                                    <i class="fas fa-utensils mr-2 text-orange-400"></i>
                                    <span x-text="food.name"></span>
                                </h4>
                                <div class="flex items-center space-x-2 bg-gradient-to-r from-green-400 to-blue-400 px-4 py-2 rounded-full">
                                    <i class="fas fa-brain text-white"></i>
                                    <span class="text-white font-bold" x-text="(food.confidence * 100).toFixed(1) + '% confident'"></span>
                                </div>
                            </div>
                            
                            <!-- Ingredients -->
                            <div x-show="food.ingredients" class="mb-6">
                                <h5 class="text-lg font-semibold text-white mb-3 flex items-center">
                                    <i class="fas fa-list mr-2 text-yellow-400"></i>
                                    Ingredients Detected
                                </h5>
                                <div class="flex flex-wrap gap-2">
                                    <template x-for="ingredient in food.ingredients">
                                        <span class="bg-gradient-to-r from-purple-400 to-pink-400 text-white px-3 py-1 rounded-full text-sm font-medium" x-text="ingredient"></span>
                                    </template>
                                </div>
                            </div>
                            
                            <!-- Nutritional Information -->
                            <div x-show="food.nutritional_info" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <template x-for="(value, key) in food.nutritional_info" :key="key">
                                    <div class="nutrition-card text-center p-4 rounded-xl hover:scale-105 transition-transform duration-300">
                                        <div class="text-3xl font-bold mb-2" 
                                             :class="getNutritionColor(key)" 
                                             x-text="value"></div>
                                        <div class="text-sm text-white/80 capitalize font-medium" x-text="key"></div>
                                        <div class="nutrition-bar mt-2">
                                            <div class="nutrition-fill" 
                                                 :style="`--fill-width: ${getNutritionPercentage(key, value)}%`"></div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Qloo Insights -->
                <div x-show="analysisResults?.qloo_insights?.length > 0" class="mt-8 bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6">
                    <h5 class="text-xl font-bold text-white mb-4 flex items-center">
                        <i class="fas fa-lightbulb text-yellow-400 mr-2 animate-pulse"></i>
                        AI Taste Insights
                    </h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <template x-for="insight in analysisResults.qloo_insights">
                            <div class="bg-gradient-to-r from-blue-500/20 to-purple-500/20 border border-blue-300/30 rounded-xl p-3 flex items-center space-x-3 hover:scale-105 transition-transform duration-300">
                                <i class="fas fa-star text-yellow-400"></i>
                                <span class="text-white font-medium" x-text="insight"></span>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preferences Tab -->
        <div x-show="activeTab === 'preferences'" 
             x-transition:enter="transition ease-out duration-500"
             x-transition:enter-start="opacity-0 transform scale-95"
             x-transition:enter-end="opacity-100 transform scale-100"
             class="space-y-8">
            
            <div class="glass-card rounded-3xl p-8 animate-fadeInUp">
                <h2 class="text-4xl font-bold text-white mb-8 text-center">
                    <i class="fas fa-cog text-yellow-300 mr-3 animate-wiggle"></i>
                    <span class="font-dancing">Customize Your Taste</span>
                    <i class="fas fa-heart text-red-400 ml-3 animate-pulse-slow"></i>
                </h2>
                
                <div class="space-y-8">
                    <!-- Dietary Restrictions -->
                    <div>
                        <label class="flex items-center text-xl font-semibold text-white mb-4">
                            <i class="fas fa-shield-alt mr-2 text-red-400"></i>
                            Dietary Restrictions & Lifestyle
                        </label>
                        <div class="flex flex-wrap gap-3">
                            <template x-for="restriction in ['vegetarian', 'vegan', 'gluten-free', 'dairy-free', 'nut-free', 'low-carb', 'keto', 'paleo']">
                                <button @click="togglePreference('dietary_restrictions', restriction)"
                                        :class="preferences.dietary_restrictions.includes(restriction) ? 'selected bg-gradient-to-r from-red-500 to-pink-500 text-white scale-110' : 'bg-white/20 text-white hover:bg-white/30'"
                                        class="preference-tag px-4 py-3 rounded-full text-sm font-bold border-2 border-white/30 backdrop-blur-sm flex items-center space-x-2">
                                    <span x-text="getRestrictionEmoji(restriction)"></span>
                                    <span x-text="restriction.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                                </button>
                            </template>
                        </div>
                    </div>

                    <!-- Cuisine Preferences -->
                    <div>
                        <label class="flex items-center text-xl font-semibold text-white mb-4">
                            <i class="fas fa-globe-americas mr-2 text-blue-400"></i>
                            Favorite Cuisines Around the World
                        </label>
                        <div class="flex flex-wrap gap-3">
                            <template x-for="cuisine in ['italian', 'chinese', 'mexican', 'indian', 'japanese', 'thai', 'american', 'french', 'mediterranean', 'korean', 'vietnamese', 'greek']">
                                <button @click="togglePreference('cuisine_preferences', cuisine)"
                                        :class="preferences.cuisine_preferences.includes(cuisine) ? 'selected bg-gradient-to-r from-blue-500 to-purple-500 text-white scale-110' : 'bg-white/20 text-white hover:bg-white/30'"
                                        class="preference-tag px-4 py-3 rounded-full text-sm font-bold border-2 border-white/30 backdrop-blur-sm flex items-center space-x-2">
                                    <span x-text="getCuisineEmoji(cuisine)"></span>
                                    <span x-text="cuisine.charAt(0).toUpperCase() + cuisine.slice(1)"></span>
                                </button>
                            </template>
                        </div>
                    </div>

                    <!-- Allergies -->
                    <div>
                        <label class="flex items-center text-xl font-semibold text-white mb-4">
                            <i class="fas fa-exclamation-triangle mr-2 text-yellow-400"></i>
                            Food Allergies & Safety
                        </label>
                        <div class="flex flex-wrap gap-3">
                            <template x-for="allergy in ['peanuts', 'tree nuts', 'shellfish', 'fish', 'eggs', 'soy', 'wheat', 'dairy', 'sesame']">
                                <button @click="togglePreference('allergies', allergy)"
                                        :class="preferences.allergies.includes(allergy) ? 'selected bg-gradient-to-r from-yellow-500 to-red-500 text-white scale-110' : 'bg-white/20 text-white hover:bg-white/30'"
                                        class="preference-tag px-4 py-3 rounded-full text-sm font-bold border-2 border-white/30 backdrop-blur-sm flex items-center space-x-2">
                                    <span x-text="getAllergyEmoji(allergy)"></span>
                                    <span x-text="allergy.replace(/\b\w/g, l => l.toUpperCase())"></span>
                                </button>
                            </template>
                        </div>
                    </div>

                    <button @click="savePreferences()" :disabled="!userId || loading"
                            class="w-full taste-button text-white py-6 px-8 rounded-2xl font-bold text-xl flex items-center justify-center space-x-4 relative z-10 hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i :class="loading ? 'fas fa-spinner loading-food' : 'fas fa-save'" class="text-2xl"></i>
                        <span x-text="loading ? 'Saving Your Taste Profile...' : 'Save My Taste Profile üíæ'"></span>
                    </button>
                </div>
            </div>

            <!-- Saved Preferences Display -->
            <div x-show="savedPreferences" 
                 x-transition:enter="transition ease-out duration-500"
                 x-transition:enter-start="opacity-0 transform translateY(20px)"
                 x-transition:enter-end="opacity-100 transform translateY(0)"
                 class="glass-card rounded-3xl p-8 border-2 border-green-400/50">
                <h3 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <i class="fas fa-check-circle text-green-400 mr-3 animate-bounce-slow"></i>
                    <span class="font-dancing">Your Taste Profile</span>
                    <i class="fas fa-sparkles text-yellow-300 ml-3 animate-pulse"></i>
                </h3>
                
                <div class="space-y-6 text-white">
                    <div x-show="savedPreferences?.dietary_restrictions?.length > 0" class="bg-white/10 rounded-2xl p-4">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-shield-alt text-red-400 mr-2"></i>
                            <strong class="text-lg">Dietary Lifestyle:</strong>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="restriction in savedPreferences.dietary_restrictions">
                                <span class="bg-gradient-to-r from-red-400 to-pink-400 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center space-x-1">
                                    <span x-text="getRestrictionEmoji(restriction)"></span>
                                    <span x-text="restriction.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                                </span>
                            </template>
                        </div>
                    </div>
                    
                    <div x-show="savedPreferences?.cuisine_preferences?.length > 0" class="bg-white/10 rounded-2xl p-4">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-globe-americas text-blue-400 mr-2"></i>
                            <strong class="text-lg">Favorite Cuisines:</strong>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="cuisine in savedPreferences.cuisine_preferences">
                                <span class="bg-gradient-to-r from-blue-400 to-purple-400 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center space-x-1">
                                    <span x-text="getCuisineEmoji(cuisine)"></span>
                                    <span x-text="cuisine.charAt(0).toUpperCase() + cuisine.slice(1)"></span>
                                </span>
                            </template>
                        </div>
                    </div>
                    
                    <div x-show="savedPreferences?.allergies?.length > 0" class="bg-white/10 rounded-2xl p-4">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-exclamation-triangle text-yellow-400 mr-2"></i>
                            <strong class="text-lg">Allergies to Avoid:</strong>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="allergy in savedPreferences.allergies">
                                <span class="bg-gradient-to-r from-yellow-400 to-red-400 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center space-x-1">
                                    <span x-text="getAllergyEmoji(allergy)"></span>
                                    <span x-text="allergy.replace(/\b\w/g, l => l.toUpperCase())"></span>
                                </span>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Messages -->
        <div x-show="error" class="fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded max-w-md">
            <div class="flex">
                <div class="py-1">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                </div>
                <div>
                    <p class="font-bold">Error!</p>
                    <p class="text-sm" x-text="error"></p>
                </div>
                <div class="pl-4">
                    <button @click="error = null" class="text-red-400 hover:text-red-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Success Messages -->
        <div x-show="success" class="fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded max-w-md">
            <div class="flex">
                <div class="py-1">
                    <i class="fas fa-check-circle mr-2"></i>
                </div>
                <div>
                    <p class="font-bold">Success!</p>
                    <p class="text-sm" x-text="success"></p>
                </div>
                <div class="pl-4">
                    <button @click="success = null" class="text-green-400 hover:text-green-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Background animation for floating food emojis
        function createFloatingFood() {
            const foodEmojis = ['üçé', 'üçï', 'üçî', 'üç£', 'üåÆ', 'üç∞', 'ü•ó', 'üçú', 'üçì', 'ü•ë', 'üçá', 'üçä', 'ü•ï', 'üåΩ'];
            const container = document.body;
            
            setInterval(() => {
                const emoji = document.createElement('div');
                emoji.textContent = foodEmojis[Math.floor(Math.random() * foodEmojis.length)];
                emoji.className = 'floating-food';
                emoji.style.left = Math.random() * 100 + 'vw';
                emoji.style.animationDuration = (Math.random() * 10 + 15) + 's';
                emoji.style.fontSize = (Math.random() * 20 + 20) + 'px';
                emoji.style.opacity = Math.random() * 0.3 + 0.1;
                container.appendChild(emoji);
                
                setTimeout(() => {
                    emoji.remove();
                }, 25000);
            }, 3000);
        }

        // Start background animations when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createFloatingFood();
        });

        function tasteTrailApp() {
            return {
                // State
                activeTab: 'recommendations',
                userId: 'user123',
                loading: false,
                error: null,
                success: null,
                apiHealth: null,

                // Recommendations
                recommendations: [],
                location: '',
                mealType: '',
                budgetRange: '',

                // Food Analysis
                imageUrl: '',
                analysisResults: null,

                // Preferences
                preferences: {
                    dietary_restrictions: [],
                    cuisine_preferences: [],
                    allergies: []
                },
                savedPreferences: null,

                // API Base URL
                apiBaseUrl: 'http://localhost:8000',

                init() {
                    this.loadPreferences();
                },

                async makeApiCall(endpoint, options = {}) {
                    try {
                        const response = await fetch(`${this.apiBaseUrl}${endpoint}`, {
                            headers: {
                                'Content-Type': 'application/json',
                                ...options.headers
                            },
                            ...options
                        });

                        if (!response.ok) {
                            const errorData = await response.json().catch(() => ({}));
                            throw new Error(errorData.detail || `HTTP ${response.status}: ${response.statusText}`);
                        }

                        return await response.json();
                    } catch (err) {
                        this.error = err.message;
                        throw err;
                    }
                },

                async checkApiHealth() {
                    this.loading = true;
                    try {
                        this.apiHealth = await this.makeApiCall('/health');
                        this.success = 'API health check completed!';
                    } catch (err) {
                        this.apiHealth = { status: 'unhealthy' };
                    } finally {
                        this.loading = false;
                    }
                },

                async getRecommendations() {
                    if (!this.userId) {
                        this.error = 'Please enter a User ID';
                        return;
                    }

                    this.loading = true;
                    try {
                        const payload = {
                            user_id: this.userId,
                            location: this.location || null,
                            meal_type: this.mealType || null,
                            budget_range: this.budgetRange || null
                        };

                        const response = await this.makeApiCall('/recommendations', {
                            method: 'POST',
                            body: JSON.stringify(payload)
                        });

                        this.recommendations = response.recommendations || [];
                        this.success = `Found ${this.recommendations.length} recommendations!`;
                    } catch (err) {
                        this.recommendations = [];
                    } finally {
                        this.loading = false;
                    }
                },

                async analyzeImage() {
                    if (!this.userId || !this.imageUrl) {
                        this.error = 'Please enter both User ID and Image URL';
                        return;
                    }

                    this.loading = true;
                    try {
                        const payload = {
                            user_id: this.userId,
                            image_url: this.imageUrl
                        };

                        this.analysisResults = await this.makeApiCall('/analyze-food-image', {
                            method: 'POST',
                            body: JSON.stringify(payload)
                        });

                        this.success = 'Image analysis completed!';
                    } catch (err) {
                        this.analysisResults = null;
                    } finally {
                        this.loading = false;
                    }
                },

                togglePreference(category, item) {
                    const index = this.preferences[category].indexOf(item);
                    if (index > -1) {
                        this.preferences[category].splice(index, 1);
                    } else {
                        this.preferences[category].push(item);
                    }
                },

                async savePreferences() {
                    if (!this.userId) {
                        this.error = 'Please enter a User ID';
                        return;
                    }

                    this.loading = true;
                    try {
                        const payload = {
                            user_id: this.userId,
                            ...this.preferences
                        };

                        await this.makeApiCall('/user-preferences', {
                            method: 'POST',
                            body: JSON.stringify(payload)
                        });

                        this.savedPreferences = { ...this.preferences };
                        this.success = 'Preferences saved successfully!';
                    } catch (err) {
                        // Error already handled in makeApiCall
                    } finally {
                        this.loading = false;
                    }
                },

                async loadPreferences() {
                    if (!this.userId) return;

                    try {
                        const response = await this.makeApiCall(`/user-preferences/${this.userId}`);
                        if (response.preferences) {
                            this.preferences = response.preferences;
                            this.savedPreferences = { ...response.preferences };
                        }
                    } catch (err) {
                        // Silently fail for preferences loading
                        console.log('No saved preferences found');
                    }
                }
            }
        }
    </script>
</body>
</html>
